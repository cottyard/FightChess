{
  "version": 3,
  "file": "battleground.js",
  "sourceRoot": "..\\..\\..",
  "sources": [
    "src\\game\\core\\battleground.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "init = ->\r\n  battleground.instance = new board.Board(true)\r\n  battleground.instance.set_out_board()\r\n  ev.hook 'end_of_rounds', on_end_of_rounds\r\n  ev.hook 'render', on_render\r\n\r\non_end_of_rounds = (evt) ->\r\n  wk = battleground.instance.count_piece 'king', 'white'\r\n  bk = battleground.instance.count_piece 'king', 'black'\r\n  if wk is 0 and bk is 0\r\n    ev.trigger_now 'game_end', { result: 'draw' }\r\n  else if wk is 0\r\n    ev.trigger_now 'game_end', { result: 'win', player: 'black' }\r\n  else if bk is 0\r\n    ev.trigger_now 'game_end', { result: 'win', player: 'white' }\r\n\r\non_render = (evt) ->\r\n  paint.board ui.ctx.static\r\n\r\n# TODO: rewrite the serialization\r\nget_state = ->\r\n  serialized_pieces = []\r\n  for pieces in battleground.instance.board\r\n    for p in pieces\r\n      if p?\r\n        serialized_pieces.push piece.serialize_piece p\r\n  buffer = new ArrayBuffer serialized_pieces.length * piece.serialization_btyes\r\n  pointer = 0\r\n  for pb in serialized_pieces\r\n    calc.write_buf_to_buf pb, buffer, 0, pointer, piece.serialization_btyes\r\n    pointer += piece.serialization_btyes\r\n  buffer\r\n\r\nset_state = (buffer) ->\r\n  battleground.instance.clean_up_board()\r\n  piece_count = buffer.byteLength / piece.serialization_btyes\r\n  pointer = 0\r\n  for i in [0...piece_count]\r\n    pb = new ArrayBuffer piece.serialization_btyes\r\n    calc.write_buf_to_buf buffer, pb, i * piece.serialization_btyes, 0, piece.serialization_btyes\r\n    p = piece.deserialize_piece pb\r\n    battleground.instance.place_piece p\r\n\r\nwindow.battleground = {\r\n  init,\r\n  instance: null,\r\n  get_state,\r\n  set_state\r\n}\r\n"
  ]
}