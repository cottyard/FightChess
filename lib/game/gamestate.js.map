{
  "version": 3,
  "file": "gamestate.js",
  "sourceRoot": "..\\..",
  "sources": [
    "src\\game\\gamestate.coffee"
  ],
  "names": [],
  "mappings": ";AAAA;AAAA,MAAA,UAAA,EAAA,QAAA,EAAA,SAAA,EAAA,IAAA,EAAA,uBAAA,EAAA,kBAAA,EAAA,aAAA,EAAA,SAAA,EAAA,UAAA,EAAA,WAAA,EAAA;;EAAA,WAAA,GAAc;;EAEd,aAAA,GAAgB,QAAA,CAAA,CAAA;AACd,QAAA;IAAA,IAAG,CAAI,WAAW,CAAC,MAAhB,GAAyB,CAA5B;AACE,aAAO,MADT;;IAEA,IAAA,GAAO,WAAW,CAAC,KAAZ,CAAA;IACP,SAAA,CAAU,IAAI,CAAC,UAAf;IACA,IAAG,IAAI,CAAC,SAAS,CAAC,KAAf,KAAwB,KAAxB,IAAkC,SAAS,CAAC,iBAAiB,CAAC,KAA5B,KAAuC,KAA5E;MACE,EAAE,CAAC,WAAH,CAAe,UAAf,EAA2B;QACzB,MAAA,EAAQ,IAAI,CAAC,SAAS,CAAC,MADE;QAEzB,MAAA,EAAQ,IAAI,CAAC,SAAS,CAAC;MAFE,CAA3B,EADF;;IAKA,IAAG,IAAI,CAAC,SAAS,CAAC,KAAf,KAAwB,SAAxB,IAAsC,SAAS,CAAC,iBAAiB,CAAC,KAA5B,KAAuC,SAAhF;MACE,EAAE,CAAC,WAAH,CAAe,YAAf,EAA6B,CAAA,CAA7B,EADF;;WAEA;EAZc;;EAchB,SAAA,GAAY,QAAA,CAAA,CAAA;WACV;MAAA,YAAA,EAAc,YAAY,CAAC,SAAb,CAAA,CAAd;MACA,MAAA,EAAQ,MAAM,CAAC,SAAP,CAAA;IADR;EADU;;EAIZ,SAAA,GAAY,QAAA,CAAC,KAAD,CAAA;IACV,YAAY,CAAC,SAAb,CAAuB,KAAK,CAAC,YAA7B;WACA,MAAM,CAAC,SAAP,CAAiB,KAAK,CAAC,MAAvB;EAFU;;EAIZ,uBAAA,GAA0B,QAAA,CAAC,GAAD,CAAA;WACxB,WAAW,CAAC,IAAZ,CAAiB,GAAjB;EADwB;;EAG1B,kBAAA,GAAqB,QAAA,CAAA,CAAA;AACnB,QAAA;IAAA,KAAA,GAAQ,SAAA,CAAA;WACR,EAAE,CAAC,WAAH,CAAe,uBAAf,EAAwC;MAAE,UAAA,EAAY,KAAd;MAAqB,SAAA,EAAW,SAAS,CAAC;IAA1C,CAAxC;EAFmB;;EAIrB,aAAA,GAAgB,QAAA,CAAC,GAAD,CAAA;WACd,EAAE,CAAC,WAAH,CAAe,uBAAf,EAAwC,CAAA,CAAxC;EADc;;EAGhB,UAAA,GAAa,QAAA,CAAA,CAAA;WACX,WAAW,CAAC;EADD;;EAGb,QAAA,GAAW,QAAA,CAAC,MAAD,EAAS,MAAT,CAAA;AACT,QAAA;IAAA,IAAc,SAAS,CAAC,iBAAiB,CAAC,KAA5B,KAAqC,SAAnD;AAAA,aAAA;;IAEA,KAAA,GAAQ,SAAS,CAAC,iBAAiB,CAAC;IACpC,OAAO,CAAC,GAAR,CAAY,MAAZ;IACA,IAAG,cAAH;MACE,OAAO,CAAC,GAAR,CAAY,IAAZ,EAAkB,MAAlB,EADF;;IAGA,SAAS,CAAC,iBAAV,GACE;MAAA,KAAA,EAAO,KAAP;MACA,MAAA,EAAQ,MADR;MAEA,MAAA,EAAQ;IAFR;AAIF,YAAO,MAAP;AAAA,WACO,MADP;QAEI,EAAE,CAAC,QAAQ,CAAC,KAAZ,GAAoB;AADjB;AADP,WAGO,KAHP;QAII,IAAG,MAAA,KAAU,KAAb;UACE,EAAE,CAAC,QAAQ,CAAC,KAAZ,GAAoB,sBADtB;SAAA,MAAA;UAGE,EAAE,CAAC,QAAQ,CAAC,KAAZ,GAAoB,mBAHtB;;AADG;AAHP;QASI,EAAE,CAAC,QAAQ,CAAC,KAAZ,GAAoB;AATxB;WAWA,EAAE,CAAC,eAAH,CAAmB,EAAE,CAAC,SAAtB,EAAiC,YAAjC;EAxBS;;EA0BX,UAAA,GAAa,QAAA,CAAC,KAAD,CAAA;IACX,OAAO,CAAC,GAAR,CAAY,CAAA,cAAA,CAAA,CAAiB,KAAjB,CAAA,CAAZ;IACA,SAAS,CAAC,iBAAV,GACE;MAAA,KAAA,EAAO,SAAP;MACA,KAAA,EAAO;IADP;IAGF,EAAE,CAAC,QAAQ,CAAC,KAAZ,GAAoB,CAAA,QAAA,CAAA,CAAW,KAAX,CAAA;WACpB,EAAE,CAAC,eAAH,CAAmB,EAAE,CAAC,SAAtB,EAAiC,cAAjC;EAPW;;EASb,IAAA,GAAO,QAAA,CAAA,CAAA;IACL,EAAE,CAAC,IAAH,CAAQ,sBAAR,EAAgC,uBAAhC;IACA,EAAE,CAAC,QAAQ,CAAC,KAAZ,GAAoB;IACpB,SAAS,CAAC,iBAAV,GACE;MAAA,KAAA,EAAO;IAAP;WACF,EAAE,CAAC,eAAH,CAAmB,EAAE,CAAC,SAAtB,EAAiC,YAAjC;EALK;;EAOP,MAAM,CAAC,SAAP,GAAmB;IACjB,IADiB;IAEjB,iBAAA,EAAmB,IAFF;IAGjB,SAHiB;IAIjB,SAJiB;IAKjB,aALiB;IAMjB,UANiB;IAOjB,kBAPiB;IAQjB,UARiB;IASjB;EATiB;AA/EnB",
  "sourcesContent": [
    "state_queue = []\r\n\r\nto_next_state = ->\r\n  if not state_queue.length > 0\r\n    return false\r\n  data = state_queue.shift()\r\n  set_state data.boardstate\r\n  if data.gamestate.state is 'end' and gamestate.current_gamestate.state isnt 'end'\r\n    ev.trigger_now 'game_end', {\r\n      result: data.gamestate.result,\r\n      player: data.gamestate.player\r\n    }\r\n  if data.gamestate.state is 'ongoing' and gamestate.current_gamestate.state isnt 'ongoing'\r\n    ev.trigger_now 'game_start', {}\r\n  true\r\n\r\nget_state = ->\r\n  battleground: battleground.get_state()\r\n  effect: effect.get_state()\r\n\r\nset_state = (state) ->\r\n  battleground.set_state state.battleground\r\n  effect.set_state state.effect\r\n\r\non_network_gamestate_in = (evt) ->\r\n  state_queue.push evt\r\n\r\nsend_current_state = ->\r\n  state = get_state()\r\n  ev.trigger_now 'network_out_gamestate', { boardstate: state, gamestate: gamestate.current_gamestate }\r\n\r\nsend_game_end = (evt) ->\r\n  ev.trigger_now 'network_out_gamestate', { }\r\n\r\ncache_size = ->\r\n  state_queue.length\r\n\r\nend_game = (result, player) ->\r\n  return unless gamestate.current_gamestate.state is 'ongoing'\r\n\r\n  color = gamestate.current_gamestate.color\r\n  console.log result\r\n  if player?\r\n    console.log 'by', player\r\n\r\n  gamestate.current_gamestate =\r\n    state: 'end'\r\n    result: result\r\n    player: player\r\n\r\n  switch result\r\n    when 'draw'\r\n      ui.gamestat.value = 'draw!'\r\n    when 'win'\r\n      if player is color\r\n        ui.gamestat.value = 'you are victorious!'\r\n      else\r\n        ui.gamestat.value = 'you are defeated'\r\n    else\r\n      ui.gamestat.value = 'game ended with unknown status'\r\n\r\n  ui.set_button_text ui.startgame, \"start game\"\r\n\r\nstart_game = (color) ->\r\n  console.log \"starting with #{color}\"\r\n  gamestate.current_gamestate =\r\n    state: 'ongoing'\r\n    color: color\r\n\r\n  ui.gamestat.value = \"playing #{color}\"\r\n  ui.set_button_text ui.startgame, \"restart game\"\r\n\r\ninit = ->\r\n  ev.hook 'network_in_gamestate', on_network_gamestate_in\r\n  ui.gamestat.value = \"waiting for start\"\r\n  gamestate.current_gamestate =\r\n    state: 'ready'\r\n  ui.set_button_text ui.startgame, \"start game\"\r\n\r\nwindow.gamestate = {\r\n  init,\r\n  current_gamestate: null,\r\n  get_state,\r\n  set_state,\r\n  to_next_state,\r\n  cache_size,\r\n  send_current_state,\r\n  start_game,\r\n  end_game\r\n}"
  ]
}