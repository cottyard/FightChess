// Generated by CoffeeScript 2.2.1
(function() {
  var end_game, init_guest, on_gametick, start_game, state_buf, sync_up_gamestate;

  state_buf = 1;

  sync_up_gamestate = function() {
    var suceeded;
    suceeded = false;
    while (gamestate.cache_size() > state_buf) {
      suceeded = gamestate.to_next_state();
    }
    return suceeded;
  };

  on_gametick = function(evt) {
    operation.send_cached_operations();
    if (sync_up_gamestate()) {
      game.render_gametick();
      if (state_buf > 3) {
        state_buf -= 0.1;
      }
    } else {
      if (gamestate.current() === 'ongoing') {
        if (state_buf < 10) {
          state_buf += 0.2;
        }
      }
    }
    return console.log("state buf", state_buf);
  };

  end_game = function(evt) {
    preview.disable();
    return gamestate.end_game(evt.result, evt.player);
  };

  start_game = function() {
    preview.set_color('black');
    return gamestate.start_game('black');
  };

  init_guest = function() {
    game.stop();
    ev.init();
    input.init();
    operation.init();
    preview.init();
    gamestate.init();
    battleground.init();
    effect.init();
    network.init();
    ui.startgame.hidden = true;
    ev.hook('gametick', on_gametick);
    ev.hook('game_end', end_game);
    return ev.hook('game_start', start_game);
  };

  window.game.init_guest = init_guest;

}).call(this);

//# sourceMappingURL=guest.js.map
